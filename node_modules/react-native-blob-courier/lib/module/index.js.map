{"version":3,"sources":["index.tsx"],"names":["NativeEventEmitter","NativeModules","BLOB_COURIER_PROGRESS_EVENT_NAME","BLOB_FETCH_FALLBACK_PARAMETERS","BLOB_MULTIPART_UPLOAD_FALLBACK_PARAMETERS","DEFAULT_FILE_MULTIPART_FIELD_NAME","convertMappedMultipartsWithSymbolizedKeysToArray","sanitizeMappedMultiparts","uuid","dict","BlobCourier","BlobCourierEventEmitter","EventEmitter","createTaskId","addProgressListener","taskId","fn","addListener","e","parsedEvent","written","parseInt","total","sanitizeSettingsData","input","progressIntervalMilliseconds","sanitizeFetchData","android","filename","headers","ios","method","mimeType","url","settings","request","optionalRequestParameters","fallback","stringifyPartsValues","parts","stringify","part","type","payload","JSON","map","sanitizeMultipartUploadData","returnResponse","wrapAbortListener","wrappedFn","signal","originalSignalOnAbort","onabort","ev","call","cancelRequest","console","debug","wrapEmitter","fnOnProgress","emitterSubscription","undefined","result","remove","emitterWrappedFetch","fetchBlob","onProgress","emitterWrappedUpload","uploadBlobFromParts","sanitized","uploadBlob","Promise","reject","uploadParts","absoluteFilePath","multipartName","requestSettings","useDownloadManagerOnAndroid","downloadManagerSettings","downloadManager","useDownloadManager"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Ely Deckers.\n *\n * This source code is licensed under the MPL-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { NativeEventEmitter, NativeModules } from 'react-native';\nimport {\n  BLOB_COURIER_PROGRESS_EVENT_NAME,\n  BLOB_FETCH_FALLBACK_PARAMETERS,\n  BLOB_MULTIPART_UPLOAD_FALLBACK_PARAMETERS,\n  DEFAULT_FILE_MULTIPART_FIELD_NAME,\n} from './Consts';\nimport './Extensions';\nimport type {\n  BlobFetchRequest,\n  BlobRequestSettings,\n  BlobRequestTask,\n  BlobFetchResponse,\n  BlobUploadRequest,\n  BlobUploadResponse,\n  AndroidDownloadManagerSettings,\n  BlobProgressEvent,\n  BlobRequestOnProgress,\n  BlobMultipartMapUploadRequest,\n  BlobMultipartArrayUploadRequest,\n  BlobNamedMultipartArray,\n  BlobMultipartWithName,\n  BlobFetchInput,\n  BlobUploadInput,\n} from './ExposedTypes';\nimport {\n  convertMappedMultipartsWithSymbolizedKeysToArray,\n  sanitizeMappedMultiparts,\n  uuid,\n} from './Utils';\nimport { dict } from './Extensions';\n\ntype BlobCancelNativeInput = BlobRequestTask;\n\ntype BlobFetchNativeInput = BlobFetchInput & BlobRequestTask;\n\ntype BlobUploadNativeInput = BlobUploadInput & BlobRequestTask;\n\ntype BlobUploadMultipartInput = BlobMultipartMapUploadRequest &\n  BlobRequestSettings;\n\ntype BlobUploadMultipartInputWithTask = BlobMultipartMapUploadRequest &\n  BlobRequestSettings &\n  BlobRequestTask;\n\ntype BlobUploadMultipartNativeInput = BlobMultipartArrayUploadRequest &\n  BlobRequestSettings &\n  BlobRequestTask;\n\ntype BlobCourierType = {\n  cancelRequest(input: BlobCancelNativeInput): Promise<{}>;\n  fetchBlob(input: BlobFetchNativeInput): Promise<BlobFetchResponse>;\n  uploadBlob(\n    input: BlobUploadMultipartNativeInput\n  ): Promise<BlobUploadResponse>;\n};\n\nconst { BlobCourier, BlobCourierEventEmitter } = NativeModules;\n\nconst EventEmitter = new NativeEventEmitter(BlobCourierEventEmitter);\n\nconst createTaskId = () => `rnbc-req-${uuid()}`;\n\nconst addProgressListener = (\n  taskId: string,\n  fn: (e: BlobProgressEvent) => void\n) =>\n  EventEmitter.addListener(BLOB_COURIER_PROGRESS_EVENT_NAME, (e: any) => {\n    const parsedEvent: BlobProgressEvent = {\n      written: parseInt(e.written, 10),\n      total: parseInt(e.total, 10),\n    };\n\n    if (e.taskId === taskId) {\n      fn(parsedEvent);\n    }\n  });\n\nconst sanitizeSettingsData = <T extends BlobRequestSettings>(\n  input: Readonly<T>\n) => {\n  const { progressIntervalMilliseconds } = input;\n\n  return {\n    progressIntervalMilliseconds,\n  };\n};\n\nconst sanitizeFetchData = <T extends BlobFetchNativeInput>(\n  input: Readonly<T>\n): BlobFetchNativeInput => {\n  const { android, filename, headers, ios, method, mimeType, taskId, url } =\n    input;\n\n  const settings = sanitizeSettingsData(input);\n\n  const request = {\n    filename,\n    mimeType,\n    url,\n  };\n\n  const optionalRequestParameters = dict({\n    ...settings,\n    android,\n    headers,\n    ios,\n    method,\n  }).fallback(BLOB_FETCH_FALLBACK_PARAMETERS);\n\n  return {\n    ...optionalRequestParameters,\n    ...request,\n    taskId,\n  };\n};\n\nconst stringifyPartsValues = (parts: BlobNamedMultipartArray) => {\n  const stringify = (part: BlobMultipartWithName) =>\n    part.type === 'string' && typeof part.payload === 'object'\n      ? { ...part, payload: JSON.stringify(part.payload) }\n      : part;\n\n  return parts.map(stringify);\n};\n\nconst sanitizeMultipartUploadData = <T extends BlobUploadMultipartNativeInput>(\n  input: Readonly<T>\n): BlobUploadMultipartNativeInput => {\n  const { parts, headers, method, returnResponse, url } = input;\n\n  const { taskId } = input;\n\n  const settings = sanitizeSettingsData(input);\n\n  const request = {\n    mimeType: 'multipart/form-data',\n    parts: stringifyPartsValues(parts),\n    url,\n  };\n\n  const optionalRequestParameters = dict({\n    headers,\n    method,\n    returnResponse,\n  }).fallback(BLOB_MULTIPART_UPLOAD_FALLBACK_PARAMETERS);\n\n  return {\n    ...settings,\n    ...optionalRequestParameters,\n    ...request,\n    taskId,\n  };\n};\n\nconst wrapAbortListener = async <T,>(\n  taskId: string,\n  wrappedFn: () => Promise<T>,\n  signal?: AbortSignal\n) => {\n  if (!signal) {\n    return await wrappedFn();\n  }\n\n  const originalSignalOnAbort = signal.onabort;\n\n  // @ts-ignore: TS2345\n  signal.onabort = (ev: Event) => {\n    if (originalSignalOnAbort) {\n      // @ts-ignore: TS2345\n      originalSignalOnAbort.call(signal, ev);\n    }\n\n    (BlobCourier as BlobCourierType).cancelRequest({ taskId });\n\n    console.debug(`Aborted ${taskId}`);\n  };\n\n  return await wrappedFn();\n};\n\nconst wrapEmitter = async <T,>(\n  taskId: string,\n  wrappedFn: () => Promise<T>,\n  fnOnProgress?: (e: BlobProgressEvent) => void\n) => {\n  const emitterSubscription = fnOnProgress\n    ? addProgressListener(taskId, fnOnProgress)\n    : undefined;\n\n  const result = await wrappedFn();\n\n  emitterSubscription?.remove();\n\n  return result;\n};\n\nconst emitterWrappedFetch = <T extends BlobFetchNativeInput>(\n  input: Readonly<T>\n) =>\n  wrapEmitter(\n    input.taskId,\n    () => (BlobCourier as BlobCourierType).fetchBlob(sanitizeFetchData(input)),\n    input.onProgress\n  );\n\nconst emitterWrappedUpload = <T extends BlobUploadMultipartInputWithTask>(\n  input: Readonly<T>\n) =>\n  wrapEmitter(input.taskId, () => uploadBlobFromParts(input), input.onProgress);\n\nconst fetchBlob = <T extends BlobFetchNativeInput>(input: Readonly<T>) =>\n  wrapAbortListener(\n    input.taskId,\n    () => emitterWrappedFetch(input),\n    input.signal\n  );\n\nconst uploadBlobFromParts = <T extends BlobUploadMultipartInputWithTask>(\n  input: Readonly<T>\n) => {\n  try {\n    const sanitized = sanitizeMappedMultiparts(input.parts);\n\n    return (BlobCourier as BlobCourierType).uploadBlob(\n      sanitizeMultipartUploadData({\n        ...input,\n        parts: convertMappedMultipartsWithSymbolizedKeysToArray(sanitized),\n      })\n    );\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nconst uploadParts = <T extends BlobUploadMultipartInputWithTask>(\n  input: Readonly<T>\n) =>\n  wrapAbortListener(\n    input.taskId,\n    () => emitterWrappedUpload(input),\n    input.signal\n  );\n\nconst uploadBlob = <T extends BlobUploadNativeInput>(input: Readonly<T>) => {\n  const { absoluteFilePath, filename, mimeType, multipartName } = input;\n\n  return uploadParts({\n    ...input,\n    parts: {\n      [multipartName ?? DEFAULT_FILE_MULTIPART_FIELD_NAME]: {\n        payload: {\n          absoluteFilePath,\n          filename,\n          mimeType,\n        },\n        type: 'file',\n      },\n    },\n  });\n};\n\nconst onProgress = (\n  taskId: string,\n  fn: (e: BlobProgressEvent) => void,\n  requestSettings?: BlobRequestSettings\n) => ({\n  fetchBlob: (input: BlobFetchRequest) =>\n    fetchBlob({\n      ...input,\n      ...requestSettings,\n      onProgress: fn,\n      taskId,\n    }),\n  uploadBlob: (input: BlobUploadRequest) =>\n    uploadBlob({\n      ...input,\n      ...requestSettings,\n      onProgress: fn,\n      taskId,\n    }),\n  uploadParts: (input: BlobUploadMultipartInput) =>\n    uploadParts({\n      ...input,\n      ...requestSettings,\n      onProgress: fn,\n      taskId,\n    }),\n  useDownloadManagerOnAndroid: (\n    downloadManagerSettings?: AndroidDownloadManagerSettings\n  ) =>\n    useDownloadManagerOnAndroid(taskId, downloadManagerSettings, {\n      ...requestSettings,\n      onProgress: fn,\n    }),\n});\n\nconst useDownloadManagerOnAndroid = (\n  taskId: string,\n  downloadManagerSettings?: AndroidDownloadManagerSettings,\n  requestSettings?: BlobRequestSettings & BlobRequestOnProgress\n) => ({\n  fetchBlob: (input: BlobFetchRequest) =>\n    fetchBlob({\n      ...input,\n      ...requestSettings,\n      android: {\n        downloadManager: downloadManagerSettings,\n        useDownloadManager: true,\n      },\n      taskId,\n    }),\n});\n\nconst settings = (taskId: string, requestSettings: BlobRequestSettings) => ({\n  fetchBlob: (input: BlobFetchRequest) =>\n    fetchBlob({\n      ...input,\n      ...requestSettings,\n      taskId,\n    }),\n  onProgress: (fn: (e: BlobProgressEvent) => void) =>\n    onProgress(taskId, fn, requestSettings),\n  uploadBlob: (input: BlobUploadRequest) =>\n    uploadBlob({\n      ...input,\n      ...requestSettings,\n      taskId,\n    }),\n  uploadParts: (input: BlobUploadMultipartInput) =>\n    uploadParts({\n      ...input,\n      ...requestSettings,\n      taskId,\n    }),\n  useDownloadManagerOnAndroid: (\n    downloadManagerSettings?: AndroidDownloadManagerSettings\n  ) =>\n    useDownloadManagerOnAndroid(\n      taskId,\n      downloadManagerSettings,\n      requestSettings\n    ),\n});\n\nexport default {\n  fetchBlob: (input: BlobFetchInput) =>\n    fetchBlob({ ...input, taskId: createTaskId() }),\n  onProgress: (fn: (e: BlobProgressEvent) => void) =>\n    onProgress(createTaskId(), fn),\n  settings: (input: BlobRequestSettings) => settings(createTaskId(), input),\n  uploadBlob: (input: BlobUploadInput) =>\n    uploadBlob({ ...input, taskId: createTaskId() }),\n  uploadParts: (input: BlobUploadMultipartInput) =>\n    uploadParts({ ...input, taskId: createTaskId() }),\n  useDownloadManagerOnAndroid: (\n    downloadManagerSettings: AndroidDownloadManagerSettings\n  ) => useDownloadManagerOnAndroid(createTaskId(), downloadManagerSettings),\n};\n\nexport * from './ExposedTypes';\nexport * from './ExposedConsts';\n"]}